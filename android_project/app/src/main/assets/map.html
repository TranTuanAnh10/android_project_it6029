<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Location Selector Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>

    <style>
        html, body, #map {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            position: absolute;
            top: 0; left: 0;
            right: 0; bottom: 0;
            z-index: 1; /* Đảm bảo map ở dưới pin */
        }
        /* --- Pin cố định ở giữa màn hình --- */
        .map-pin {
            position: absolute;
            top: 50%;
            left: 50%;
            /* Căn chính giữa trục X, và dịch lên 100% chiều cao để đầu pin nằm ở tâm */
            transform: translate(-50%, -100%);
            z-index: 1000; /* Đảm bảo pin luôn ở trên map */
            pointer-events: none; /* Không chặn tương tác với map */
        }
        .map-pin img {
            /* Bạn nên sử dụng hình ảnh Pin màu đỏ của riêng mình */
            width: 35px;
            height: 35px;
        }
    </style>
</head>
<body>
<div id="map"></div>

<div class="map-pin">
    <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" alt="Location Pin">
</div>

<script>
    // --- 1. Khởi tạo map ---
    var map = L.map('map', {
        zoomControl: false,
        attributionControl: false
    }).setView([32.986, -96.756], 15); // Tọa độ mẫu: Richardson, TX (gần như ảnh)

    // --- 2. Nền map ---
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
        attribution: '&copy; CartoDB & OpenStreetMap'
    }).addTo(map);

    // --- 3. Hàm gửi toạ độ trung tâm về Android ---
    function sendCenterToAndroid() {
        const center = map.getCenter();
        const lat = center.lat;
        const lng = center.lng;

        // Gửi toạ độ về giao diện Java (Android)
        // Hàm onLocationChanged sẽ được định nghĩa trong mã Java
        if (window.Android && window.Android.onLocationChanged) {
            window.Android.onLocationChanged(lat, lng);
        }
    }

    // Lắng nghe sự kiện khi map ngừng di chuyển (sau khi người dùng kéo)
    map.on('moveend', sendCenterToAndroid);

    // Gửi tọa độ ban đầu sau khi map tải xong
    map.on('load', sendCenterToAndroid);

</script>
</body>
</html>